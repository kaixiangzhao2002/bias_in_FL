AllReduce-based Federated Learning with Resource Scheduling